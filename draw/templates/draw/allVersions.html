
<!-- {% load static %} -->
<!-- <div>Icons made by <a href="https://www.flaticon.com/authors/smashicons" title="Smashicons">Smashicons</a> from <a href="https://www.flaticon.com/"                 title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/"                 title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div> -->
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>All Versions</title>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Pacifico" rel="stylesheet">

    <style type="text/css">
      html{
        overflow-y: hidden;
      }
      .main{
        display:flex;
        flex-direction:column;
        align-items:center;
        background-color: #FBFBFB;
/*           #b7c5d7; */
      }
      .header{
        width: 288px;
        margin-top: 44px;
        font-family: 'Roboto', sans-serif;
        font-style: normal;
        font-weight: bold;
        font-size: 40px;
        line-height: 47px;
      }
       .tags-row, .snippet-list {
        flex-direction: row;
        display:flex;
        width:80vw;
        margin-top:20px;
        justify-content:space-between;
        font-family: PT Sans;
        font-size: 1em;
      }
      #tag-btn {
        border-radius: 100px;
        padding-right: 20px;
        padding-left: 20px;
      }
      #sort-list {
        align-content: flex-end;
      }
      .snippet-list{
        justify-content:flex-start !important;
        width: 82vw;
        margin-top:14px;
        height:65vh;
        /* background-color: black;  */
        flex-wrap: wrap;
        overflow-y: scroll;
        overflow-x: hidden;
        border-radius: 18px;
      }

      .one-doc:nth-child(3n) {
        margin-right:2vh;
      }

      .one-doc {
        width: 43vh;
        height: 38vh;
        /* 35 : 15 */
        background-color: #FFFFFF;
        margin: 1.5vh 7vh 5vh 2.0vh;
        border-radius: 30px;
        box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.2);
        cursor: pointer;
      }

      .one-doc.active {
        box-shadow: 0 0 3pt 2.2pt lightBlue ;
      }

      .one-doc.hover{
        box-shadow: 0px 10px 10px rgba(0, 0, 0, 0.2);
      }

      #snippet {
        height: 24.5vh;
        border-top-left-radius: 30px;
        border-top-right-radius: 30px;
        background-color: white;
      }
      #snippet-info{
        position: relative;
        height: 10.5vh;
        border-bottom-left-radius: 30px;
        border-bottom-right-radius: 30px;
        background-color: white;
        box-shadow: 0px -4px 4px rgba(0, 0, 0, 0.1);
        padding: 0.9em 1.2em 0 1.2em;
      }
      #snippet-title {
        font-family: 'Roboto', sans-serif;
        font-style: normal;
        font-weight: normal;
        line-height: 28px;
        font-size: 24px;
      }
      #snippet-tag {
        display:flex;
      }
      #snippet-date {
        display: flex;
        font-size: 10px;
        justify-content: space-between;
        /* background-color: white; */
      }
      .edit-pen {
        position: relative;
        left: 38vh;
        top: 2vh;
        /* display: none; */
        visibility: hidden;
      }
      .select-btn {
        position: relative;
        left: 25.5vh;
        top: 1.2vh;
        display: visible;
        height: 64.75%;
        width: 64.75%;
      }
      .plus-btn {
        position: relative;
        left: 23.5vh;
        top: 1vh;
        visibility: visible;
        height: 74%;
        width: 74%;
        filter: invert(35%);
      }
      .icon-area{
        /* position: absolute; */
        width: 43vh;
        height: 4vh;
      }
      .snippet-text{
        padding: 0em 2em 0em 2em;
        overflow: hidden;
        height: 25vh;
      }
      #snippet-tag {
        align-items: center;
      }
      /*https://stackoverflow.com/questions/33911049/btn-xs-no-longer-a-valid-option-in-bootstrap-4*/
      .btn-xs {
        padding: .25rem .4rem;
        font-size: .875rem;
        line-height: .5;
        border-radius: .2rem;
      }
      .compare-row, .compare-row2 {
        margin-top: 1em;
        align-items: center;
      }
      #compare-btn, #confirm-btn, #cancel-btn {
        background-color: #858585;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.15);
        border-radius: 27px;
        color: white;
      }
      #confirm-btn, #cancel-btn {
        margin-right: 30px;
        margin-left: 30px;
      }
      #compare-btn:active, #confirm-btn:active, #cancel-btn:active {
        border-color: #ababab;
        box-shadow: inset 0 10px 10px rgba(0, 0, 0, .125);
      }
    </style>

</head>
<body class='main'>
  <div class='header'>
    Introduction
  </div>
    <div class = "tags-row">

      <div id = "tags">
        <p style = "display: inline; padding-right: 10px;">
        All TAGS:
        </p>
      </div>

      <div id = "sort-list">
        <p style = "display: inline; padding-right: 10px;">
          SORT BY:
        </p>

        <div style = "display:inline">
          <select name = "sort-list-box">
            <option value = "Date Created Old">Date Created - Oldest to Newest</option>
            <option value = "Date Created New">Date Created - Newest to Oldest</option>
            <option value = "Date Modified Old">Date Modified - Oldest to Newest</option>
            <option value = "Date Created New">Date Modified - Newest to Oldest</option>
            <option value = "Alpha"> Alphabetical Order</option>
          </select>
        </div>

      </div>
    </div>


    <div class = "snippet-list">
    </div>

    <div class = "compare-row">
      <button type="button" class = "btn" id="compare-btn">Select to Compare</button>
    </div>

    <div class = "compare-row2" style = "display:none;">
      <button type="button" class = "btn" id="confirm-btn">Compare</button>
      <button type="button" class = "btn" id="cancel-btn">Cancel</button>
    </div>

</body>

<script>
  $( "select" ).change(function() {
    var sortingMethod = this.value
    if (sortingMethod == "Date Created Old"){
      sortDateCreatedOld()
    }else if (sortingMethod == "Date Created New"){
      sortDateCreatedNew()
    }else if (sortingMethod == "Date Modified Old"){
      console.log("asdf")
      sortDateModifiedOld()
    }else if (sortingMethod == "Date Modified New"){
      sortDateModifiedNew()
    }else if (sortingMethod == "Alpha"){
      sortAlpha()
    }
  });


  function sortDateCreatedOld(){
    var docs = $('.one-doc')
    docs.sort(function(a, b){
      return new Date($(a).find("#database-date-created").text()) - new Date($(b).find("#database-date-created").text());
    });
    $(".snippet-list").html(docs);
  }


  function sortDateCreatedNew(){
    var docs = $('.one-doc')

    docs.sort(function(a, b){
      return new Date($(b).find("#database-date-created").text()) - new Date($(a).find("#database-date-created").text());
    });

    $(".snippet-list").html(docs);
  }


  function sortDateModifiedOld(){
    var docs = $('.one-doc')
    docs.sort(function(a, b){
      return new Date($(a).find("#database-date-modified").text()) - new Date($(b).find("#database-date-modified").text());
    });
    $(".snippet-list").html(docs);
  }


  function sortDateModifiedNew(){
    var docs = $('.one-doc')

    docs.sort(function(a, b){
      return new Date($(b).find("#database-date-modified").text()) - new Date($(a).find("#database-date-modified").text());
    });

    $(".snippet-list").html(docs);
  }

  function sortAlpha(){
    var docs = $('.one-doc')

    docs.sort(function(a, b){
      if ($(a).find("#snippet-title").text() <= $(b).find("#snippet-title").text()){
        return 1
      }else{
        return -1
      }
    });

     $(".snippet-list").html(docs);
    
  }



    var storage = window.sessionStorage;
    // storage.clear();
    // var alltags = ['happy', 'sad', 'draft','final'];
    // var version_1={
    //   title:'Version1',
    //   text:{"ops":[{"insert":"This is version 1!\n"}]},
    //   unformattext:'This is version 1!\n',
    //   tag:['draft','sad'],
    //   modified:'8/10/2019',
    //   created:'5/11/2019'
    // };
    // var version_2={
    //   title:'aVersion2',
    //   text:{"ops":[{"insert":"This is version 2!\n"}]},
    //   unformattext:'This is version 2!\n',
    //   tag:['happy'],
    //   modified:'8/14/2019',
    //   created:'3/11/2019'
    // };
    // var versionname_1 = Math.random();
    // var versionname_2 = Math.random();
    // var versionlist = [versionname_1,versionname_2];
    // storage['versionlist']=JSON.stringify(versionlist);
    // storage[versionname_1]=JSON.stringify(version_1);
    // storage[versionname_2]=JSON.stringify(version_2);
    // storage['alltags']=JSON.stringify(alltags);

    var similartags = JSON.parse(storage.alltags);
    similartags.forEach(function(element) {
      var tag = '<button type="button" class="btn btn-dark btn-sm tag-btn" id = "tag-btn">'
                      + element
                      + '</button>'
      $('#tags').append(tag);
    });
  
    var showAllTag = '<button type="button" class="btn btn-dark btn-sm tag-btn alltag" id = "tag-btn" onClick = "window.location.reload(false)">'
                      + "Show All Tags"
                      + '</button>'
    $('#tags').append(showAllTag);
  
//     var loadUrl = "http://ahjk-jach866608.codeanyapp.com/draw/allVersions/"
//     $("#alltag").click(function(){
//           $("#alltag").html(loadUrl).load(loadUrl);
//       });
  
  var versionlist = JSON.parse(storage.versionlist);
  versionlist.forEach(function(element) {
    var snippetversion = JSON.parse(storage[element]);
    var onesnippettag = '';
    snippetversion.tag.forEach(function(element) {
      onesnippettag += '<button type="button" class="btn btn-dark btn-xs" id = "snippet-tag-btn">'
                      + element
                      + '</button> '
    });
    var onesnippet =
        '<div class = "one-doc" id='
          +element+
        '><div id = "snippet"><div class = "icon-area"><i class="fa fa-pencil-square-o edit-pen" aria-hidden="true"></i></div><div class = "snippet-text"><pre>'
          + snippetversion.unformattext+
        '</pre></div></div><div id = "snippet-info"><div id = "snippet-title">'
          + snippetversion.title+
        '</div><div id = "snippet-tag"><p style = "display: inline-block; margin-right: 10px; margin-bottom: 0px;">TAGS</p><div id = "tag-buttons">'
          + onesnippettag+
        '</div></div><div id = "snippet-date"><div id = "snippet-created" style = "display: flex"><p style = "display:inline; margin-right: 10px;">Date Created</p><div id = "database-date-created">'
          + snippetversion.created+
        '</div></div><div id = "snippet-modified" style = "display: flex"><p style = "display:inline; margin-right: 10px;">Date Modified</p><div id = "database-date-modified">'
          + snippetversion.modified+
        '</div></div></div></div></div>';
    $('.snippet-list').append(onesnippet);
  })

  var comparelist=[];

  
  var compareBtn = false;
  $(".snippet-list").on('mouseenter', '.one-doc', function(){
      $($(this)[0].childNodes[0].childNodes[0].childNodes[0]).css('visibility','visible');
  });
  $(".snippet-list").on('mouseleave', '.one-doc', function(){
    if ($(".edit-pen").is(":visible")) {
      $($(this)[0].childNodes[0].childNodes[0].childNodes[0]).css('visibility','hidden');
    }
  });
  $(".snippet-list").on('click', '.one-doc', function(){
    var snippetclicked = Number($(this)[0].id);
    if (compareBtn == true){
      $(this).removeClass('hover');
      if ($(this).hasClass('active')){
        $(this).removeClass('active');
        $($(this)[0].childNodes[0].childNodes[0]).html('<img src="../../static/icons/plus-btn.svg" class = "plus-btn">');
        var index = comparelist.indexOf(snippetclicked);
        comparelist.splice(index, 1);
      } else {
        comparelist.push(Number(snippetclicked));
        // $($(this)[0].childNodes[1].childNodes[1]).html('<i class="fas fa-check-circle select-btn"></i>');
        $($(this)[0].childNodes[0].childNodes[0]).html('<img src="../../static/icons/check-circle-solid.svg" class = "select-btn">');

        $(this).addClass('active');
      }
    }else{
      window.location.href='../?version='+snippetclicked;
    }
  });
  $( "#compare-btn" ).click(function(){
    compareBtn = true;
    $(".icon-area").html('<img src="../../static/icons/plus-btn.svg" class = "plus-btn">');
    $(".compare-row").hide();
    $(".compare-row2").show();
    compareHover();
  });

  function compareHover (){
    $(".snippet-list").on('mouseenter', '.one-doc', function(){
      if ($(this).hasClass('active') != true){
          $(this).addClass('hover');
        }
    });
    $(".snippet-list").on('mouseleave', '.one-doc', function(){
          $(this).removeClass('hover');
    });
  }

  $( "#cancel-btn" ).click(function(){
    compareBtn = false;
    $(".one-doc").removeClass('active');
    $(".icon-area").html('<i class="fa fa-pencil-square-o edit-pen" aria-hidden="true"></i>');
    $($(".one-doc")[0].childNodes[1].childNodes[1].childNodes[0]).css('visibility','hidden');
    $(".compare-row").show();
    $(".compare-row2").hide();
  });

  $( "#confirm-btn" ).click(function(){
    storage['comparelist']=JSON.stringify(comparelist);
    window.location.href='../compare';
  });
  
  $('.tag-btn').click(function(){
   var selectedtag = $(this)[0].childNodes[0].data;
    $('.snippet-list').html('');
    versionlist.forEach(function(element) {
      var snippetversion = JSON.parse(storage[element]);
      if (snippetversion.tag.indexOf(selectedtag) > -1){
        var onesnippettag = '';
        snippetversion.tag.forEach(function(element) {
          onesnippettag += '<button type="button" class="btn btn-dark btn-xs" id = "snippet-tag-btn">'
                          + element
                          + '</button> '
        });
        var onesnippet =
            '<div class = "one-doc" id='
              +element+
            '><div id = "snippet"><div class = "icon-area"><i class="fa fa-pencil-square-o edit-pen" aria-hidden="true"></i></div><div class = "snippet-text"><pre>'
              + snippetversion.unformattext+
            '</pre></div></div><div id = "snippet-info"><div id = "snippet-title">'
              + snippetversion.title+
            '</div><div id = "snippet-tag"><p style = "display: inline-block; margin-right: 10px; margin-bottom: 0px;">TAGS</p><div id = "tag-buttons">'
              + onesnippettag+
            '</div></div><div id = "snippet-date"><div id = "snippet-created" style = "display: flex"><p style = "display:inline; margin-right: 10px;">Date Created</p><div id = "database-date-created">'
              + snippetversion.created+
            '</div></div><div id = "snippet-modified" style = "display: flex"><p style = "display:inline; margin-right: 10px;">Date Modified</p><div id = "database-date-modified">'
              + snippetversion.modified+
            '</div></div></div></div></div>';
        $('.snippet-list').append(onesnippet);
      }
  });

    
  });
</script>
</html>
